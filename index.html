<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>맨션맨 투자 시뮬레이터 (Pro)</title>
  <style>
    :root{
      --bg:#ffffff; --ink:#111827; --muted:#6b7280; --line:#e5e7eb;
      --card:#ffffff; --accent:#8B0000; --accent-ink:#ffffff;
      --soft:#f9fafb; --pill:#f1f5f9;
    }
    *{ box-sizing:border-box; }
    html,body{ margin:0; padding:0; background:var(--bg); color:var(--ink);
      font:14px/1.55 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue","Apple SD Gothic Neo","Noto Sans KR","Malgun Gothic","맑은 고딕",Arial,sans-serif;}
    .wrap{ max-width:980px; margin:0 auto; padding:18px; }
    h1{ font-size:20px; margin:4px 0 10px; letter-spacing:-0.2px; }
    .sub{ color:var(--muted); font-size:12px; margin-bottom:16px; }

    .grid{ display:grid; grid-template-columns:1fr; gap:12px; }
    @media (min-width: 820px){ .grid{ grid-template-columns: 1fr 1fr; } }

    .card{ background:var(--card); border:1px solid var(--line); border-radius:14px; padding:14px; }
    .card h2{ font-size:16px; margin:0 0 10px; }

    label{ display:block; font-size:12px; color:var(--muted); margin-bottom:6px; }
    .row{ display:flex; gap:10px; }
    .row > div{ flex:1; }

    input[type="text"], input[type="number"]{
      width:100%; padding:11px 12px; border-radius:10px; border:1px solid var(--line);
      background:#fff; color:var(--ink); font-size:16px;
    }
    input::placeholder{ color:#94a3b8; opacity:.6; } /* 반투명 예시 */

    .pill{ display:inline-flex; align-items:center; gap:8px; background:var(--pill); color:var(--ink); border:1px solid var(--line); border-radius:999px; padding:6px 10px; font-size:12px; }
    .hint{ font-size:11px; color:#64748b; margin-top:6px; }
    .btns{ display:flex; gap:10px; margin-top:12px; }
    button{ appearance:none; border:0; padding:12px 14px; border-radius:10px; font-weight:600; cursor:pointer; }
    .primary{ background:var(--accent); color:var(--accent-ink); }
    .ghost{ background:transparent; color:var(--ink); border:1px solid var(--line); }

    /* 결과값 공통 – 숫자 한 줄로 표시되도록 */
    .kpi{
      display:grid; grid-template-columns:1fr 1fr; /* 2열 */
      gap:12px; margin-top:12px;
    }
    .kpi .item{
      background:var(--soft); border:1px solid var(--line); border-radius:12px; padding:16px;
      min-height:68px; display:flex; flex-direction:column; justify-content:center;
    }
    .kpi .label{ font-size:12px; color:var(--muted); margin-bottom:4px; }
    .kpi .val{
      font-size:14px; line-height:1.35; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
      font-variant-numeric: tabular-nums;
    }

    /* 결과 카드 상단의 핵심 4개 강조 */
    .kpi.kpi-top .item{ border:2px solid var(--accent); }
    .kpi.kpi-top .val{ font-size:16px; font-weight:800; }

    .sep{ height:1px; background:var(--line); margin:12px 0; }
    .footer{ color:#6b7280; font-size:11px; margin-top:14px; }

    /* 토글 */
    .toggle{ display:flex; gap:8px; flex-wrap:wrap; }
    .chip{
      border:1px solid var(--line); padding:6px 10px; border-radius:999px; font-size:12px; cursor:pointer; user-select:none;
      display:inline-flex; align-items:center; gap:6px; background:var(--pill);
    }
    .chip input{ appearance:none; width:14px; height:14px; border:2px solid var(--accent); border-radius:50%; display:inline-block; }
    .chip input:checked{ background:var(--accent); border-color:var(--accent); }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>맨션맨 투자 시뮬레이터 (Pro)</h1>
    <div class="sub">오프라인 동작 · 외부 라이브러리/폰트 없음 · 상환방식: 원금균등</div>

    <div class="grid">
      <!-- 입력 카드 -->
      <div class="card">
        <h2>기본 입력</h2>
        <div class="row">
          <div><label>매입가 (엔)</label><input id="purchasePrice" placeholder="¥100,000,000"></div>
          <div><label>대출 LTV (%)</label><input id="ltv" placeholder="70"></div>
        </div>
        <div class="row">
          <div><label>금리 (연, %)</label><input id="rate" placeholder="2"></div>
          <div>
            <label>상환기간</label>
            <div class="toggle">
              <label class="chip"><input type="radio" name="term" value="25" checked> 신축 25년</label>
              <label class="chip"><input type="radio" name="term" value="20"> 중고 20년</label>
            </div>
            <div class="hint">※ 신축은 취득세 1,200만엔 공제 적용</div>
          </div>
        </div>
        <div class="row">
          <div><label>월 임대료 (엔)</label><input id="rentM" placeholder="¥350,000"></div>
          <div><label>관리비 (% 임대료)</label><input id="mgmtPct" placeholder="5"></div>
        </div>
        <div class="row">
          <div><label>고정자산세 (% 매입가)</label><input id="fixedTaxPct" placeholder="0.3"></div>
          <div><label>기타 초년도 비용 (% 매입가)</label><input id="initCostPct" placeholder="0.5"></div>
        </div>
        <h2>취득세(자동)</h2>
        <div class="row">
          <div><label>평가비율 (%)</label><input id="assessRatio" placeholder="50"></div>
          <div><label>취득세율 (%)</label><input id="acqTaxRate" placeholder="3"></div>
        </div>
        <h2>매도 가정</h2>
        <div class="row">
          <div><label>보유기간 (년)</label><input id="holdY" placeholder="5"></div>
          <div><label>매도가 (엔)</label><input id="salePrice" placeholder="¥130,000,000"></div>
        </div>
        <div class="row">
          <div><label>매도비용 (% 매도가)</label><input id="saleCostPct" placeholder="3"></div>
          <div><label>통화 표기</label><div class="pill">엔(¥)</div></div>
        </div>
        <div class="btns">
          <button class="primary" id="calcBtn">계산하기</button>
          <button class="ghost" id="resetBtn">초기화</button>
        </div>
      </div>

      <!-- 결과 카드 -->
      <div class="card">
        <h2>결과</h2>
        <div class="kpi kpi-top">
          <div class="item"><div class="label">년간 순이익</div><div class="val" id="heroNetAnnual">-</div></div>
          <div class="item"><div class="label">년간 투자수익률</div><div class="val" id="heroRoiAnnual">-</div></div>
          <div class="item"><div class="label">매도가</div><div class="val" id="heroSalePrice">-</div></div>
          <div class="item"><div class="label">매도후 수익률</div><div class="val" id="heroRoiExit">-</div></div>
        </div>
        <div class="sep"></div>
        <div class="kpi">
          <div class="item"><div class="label">대출금액</div><div class="val" id="loanAmount">-</div></div>
          <div class="item"><div class="label">초기 자기자본</div><div class="val" id="equityInit">-</div></div>
          <div class="item"><div class="label">연간 이자(1년차)</div><div class="val" id="intYear1">-</div></div>
          <div class="item"><div class="label">영업현금흐름(연)</div><div class="val" id="operCF">-</div></div>
        </div>
        <div class="sep"></div>
        <div class="kpi">
          <div class="item"><div class="label">취득세</div><div class="val" id="acqTaxOut">-</div></div>
          <div class="item"><div class="label">기타 초년도 비용</div><div class="val" id="initOthersOut">-</div></div>
          <div class="item"><div class="label">보유기간 이자 합계</div><div class="val" id="intHold">-</div></div>
          <div class="item"><div class="label">매도시 남은 원금</div><div class="val" id="remPrincipal">-</div></div>
        </div>
        <div class="sep"></div>
        <div class="hint">※ 취득세는 신축 25년 선택 시 1,200만 엔 공제 반영</div>
        <div class="footer">단순 계산 예시입니다. 실제 계약 전 별도 검토 필요.</div>
      </div>
    </div>
  </div>

  <script>
    function parseKR(n){ if(!n) return 0; return Number(String(n).replace(/[^\d.-]/g,''))||0; }
    function fmt(n){ return isFinite(n)?n.toLocaleString():'-'; }
    function fmtPct(x){ return isFinite(x)?(x*100).toFixed(1)+'%':'-'; }

    function buildSchedule(loan,r,years){
      const mR=r/100/12,n=years*12,p=loan/n;let b=loan,arr=[];
      for(let i=0;i<n;i++){let it=b*mR;b-=p;arr.push({it,bal:b<0?0:b});}
      return arr;
    }
    function sumInt(s,y){return s.slice((y-1)*12,y*12).reduce((a,v)=>a+v.it,0);}
    function remPrin(s,y){return s[Math.min(s.length-1,y*12-1)].bal;}

    function calc(){
      const P=parseKR(document.getElementById('purchasePrice').value),
            LTV=+document.getElementById('ltv').value||0,
            rA=+document.getElementById('rate').value||0,
            rentM=parseKR(document.getElementById('rentM').value),
            mgmtPct=+document.getElementById('mgmtPct').value||0,
            fixPct=+document.getElementById('fixedTaxPct').value||0,
            initPct=+document.getElementById('initCostPct').value||0,
            assess=+document.getElementById('assessRatio').value||0,
            acqR=+document.getElementById('acqTaxRate').value||0,
            holdY=parseInt(document.getElementById('holdY').value)||0,
            saleP=parseKR(document.getElementById('salePrice').value),
            saleC=+document.getElementById('saleCostPct').value||0,
            years=+document.querySelector('input[name="term"]:checked').value;

      const loan=P*LTV/100, assessed=P*assess/100, ded=(years===25?12000000:0);
      const acqTax=Math.max(0,assessed-ded)*acqR/100, initO=P*initPct/100;
      const eqInit=(P-loan)+acqTax+initO;

      const rentY=rentM*12, mgmt=rentY*mgmtPct/100, fix=P*fixPct/100, opCF=rentY-mgmt-fix;
      const sched=buildSchedule(loan,rA,years), int1=sumInt(sched,1), net=opCF-int1, roi=net/eqInit;

      let intHold='-',rem='-',roiE='-';
      if(holdY>0&&saleP>0){
        let ih=0;for(let y=1;y<=Math.min(years,holdY);y++)ih+=sumInt(sched,y);
        const netSum=opCF*holdY-ih,saleCost=saleP*saleC/100,remP=remPrin(sched,holdY);
        const exit=(saleP-saleCost)-remP, tot=netSum+exit;intHold=ih;rem=remP;roiE=tot/eqInit;
      }

      document.getElementById('heroNetAnnual').innerText='¥'+fmt(net);
      document.getElementById('heroRoiAnnual').innerText=fmtPct(roi);
      document.getElementById('heroSalePrice').innerText=saleP?'¥'+fmt(saleP):'-';
      document.getElementById('heroRoiExit').innerText=isFinite(roiE)?fmtPct(roiE):'-';

      document.getElementById('loanAmount').innerText='¥'+fmt(loan);
      document.getElementById('equityInit').innerText='¥'+fmt(eqInit);
      document.getElementById('intYear1').innerText='¥'+fmt(int1);
      document.getElementById('operCF').innerText='¥'+fmt(opCF);
      document.getElementById('acqTaxOut').innerText='¥'+fmt(acqTax);
      document.getElementById('initOthersOut').innerText='¥'+fmt(initO);
      document.getElementById('intHold').innerText=isFinite(intHold)?'¥'+fmt(intHold):'-';
      document.getElementById('remPrincipal').innerText=isFinite(rem)?'¥'+fmt(rem):'-';
    }
    document.getElementById('calcBtn').onclick=calc;
    document.getElementById('resetBtn').onclick=()=>location.reload();
  </script>
</body>
</html>
